<?xml version="1.0" encoding="UTF-8"?>
<gate>
	<name>MegafonMoscowMMS</name>
	<caption>Мегафон Москва MMS</caption>
	<type>MMS</type>
	<class>HTTP</class>
	<version>2</version>
	<priority>5</priority>
	<country>Россия</country>
	<prefixlist>
		<prefix start="7 925"/>
		<prefix start="7 926"/>
		<prefix start="7 495 500" end="7 495 507"/>
		<prefix start="7 495 51"/>
		<prefix start="7 495 542" end="7 495 543"/>
		<prefix start="7 495 771" end="7 495 772"/>
	</prefixlist>
	<info>
		<maxsymbols>80000</maxsymbols>
		<maxunicodesymbols>80000</maxunicodesymbols>
		<supportflash>0</supportflash>
		<supportdtdelivery>0</supportdtdelivery>
		<supportunicode>1</supportunicode>
		<supportcheckdelivery>1</supportcheckdelivery>
		<captcha>1</captcha>
		<gateurl>http://moscow.megafon.ru/mms/</gateurl>
		<supportmultimedia>1</supportmultimedia>
		<supportaudio>0</supportaudio>
		<supportimage>1</supportimage>
		<sendwomultimedia>1</sendwomultimedia>
		<maxmultimediacount>1</maxmultimediacount>
		<maxmultimediasize>80000</maxmultimediasize>
	</info>
	<classprops>
		<encoding>UTF-8</encoding>
		<pageurl>http://moscow.megafon.ru/mms/?from=first</pageurl>
		<multipart>0</multipart>
		<imageurl>eval('http://moscow.megafon.ru/mms/image.phtml?k=' + Html.RegExp('/image\.phtml\?k=(.*?)&quot;',1))</imageurl>
		<posturl>http://moscow.megafon.ru/mms/action.phtml</posturl>
		<multipart>1</multipart>
		<postdata>eval(
			begin
				PostData.Add('selectedTab','myfile');
				PostData.Add('selImage','-1');
				PostData.Add('selVideo','-1');
				PostData.Add('preview','');
				PostData.Add('delete_img','');
				PostData.Add('area','mms');
				PostData.Add('action','submitmms');
				PostData.Add('charcheck','йцукен');
				PostData.Add('def',MMS['Phone_Def']);
				PostData.Add('number',MMS['Phone_Number']);
				PostData.Add('subject',MMS['Subject']);
				PostData.Add('body',MMS['Text']);
				PostData.Add('MAX_FILE_SIZE','4000000');
				if Assigned(MMS['MultiMedia']) then
					PostData.AddData('uploaded_file',MMS['MultiMedia']);
				PostData.Add('imageSize','0');
				PostData.Add('imagetext','');
				PostData.Add('fontsize','9');
				PostData.Add('fontcolor','Черный');
				PostData.Add('captcha_key',HTML.RegExp('name=&quot;captcha_key&quot; value=&quot;(.*?)&quot;',1));
				PostData.Add('captcha',MMS['Code']);
			end;
		)
		</postdata>
		<handleredirects>1</handleredirects>
		<success>eval(Html.ExistsStr('Проверить статус'))</success>
		<error>eval(
				begin
					Result:=Html.RegExp('&lt;small&gt;(.*?)&lt;/small&gt;',1);
					if Result='' then
						Result:='Неизвестная ошибка';
				end;		
			)</error>
		<cd_method>GET</cd_method>
		<cd_url>http://moscow.megafon.ru/mms/?view=status</cd_url>
		<cd_success>eval(
							begin
								if HTML.ExistsStr('Сообщение поставлено в очередь') then
									Result:='WAIT'
								else if HTML.ExistsStr('Сообщение в процессе доставки') then
									Result:='WAIT'
								else Result:=HTML.ExistsStr('Сообщение доставлено');
							end;
						)
		</cd_success>
		<cd_error>Ошибка подтверждения доставки</cd_error>
	</classprops>
</gate>